<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TG Drive - Clean Layout</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="static/home.css" />
    <link rel="stylesheet" href="static/css/context-menu.css" />
    <style>
        body { 
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
        }
        
        /* New Upload Dropdown Styles */
        .new-upload {
            position: absolute;
            top: 40px;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            z-index: -1;
            opacity: 0;
            transition: all 0.3s ease;
            padding: 8px 0;
            margin: 0 12px;
        }
        
        .upload-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            color: #374151;
        }
        
        .upload-option:hover {
            background-color: #f3f4f6;
        }
        
        .upload-option svg {
            color: #6b7280;
        }
        
        .upload-option span {
            font-size: 14px;
            font-weight: 400;
        }
        
        .new-upload hr {
            margin: 8px 0;
            border: none;
            border-top: 1px solid #e5e7eb;
        }
        
        /* Sidebar navigation styles */
        .selected-item {
            background-color: #dbeafe;
            color: #2563eb;
            font-weight: 500;
            border-radius: 0 9999px 9999px 0;
        }
        
        .unselected-item {
            color: #374151;
            border-radius: 0 9999px 9999px 0;
        }
        
        .unselected-item:hover {
            background-color: #f3f4f6;
        }
        
        /* Selection Mode Styling - Enhanced */
        .selection-mode {
            background-color: #f8f9ff;
        }
        
        .file-item.selected {
            background-color: #c2e7ff !important;
            border: 2px solid #1a73e8 !important;
            border-radius: 8px !important;
            box-shadow: 0 2px 8px rgba(26, 115, 232, 0.3) !important;
            transform: translateY(-1px);
            transition: all 0.2s ease;
        }
        
        .file-item.selected:hover {
            background-color: #a8dcff !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 115, 232, 0.4) !important;
        }
        
        .checkbox-column {
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            width: 40px !important;
            min-width: 40px !important;
        }
        
        .file-checkbox {
            appearance: none !important;
            width: 18px !important;
            height: 18px !important;
            border: 2px solid #dadce0 !important;
            border-radius: 3px !important;
            cursor: pointer !important;
            position: relative !important;
            transition: all 0.2s ease !important;
            background: white !important;
        }
        
        .file-checkbox:checked {
            background-color: #1a73e8 !important;
            border-color: #1a73e8 !important;
        }
        
        .file-checkbox:checked::after {
            content: '✓' !important;
            position: absolute !important;
            top: -1px !important;
            left: 2px !important;
            color: white !important;
            font-size: 12px !important;
            font-weight: bold !important;
        }
        
        .file-checkbox:hover {
            border-color: #1a73e8 !important;
            transform: scale(1.1) !important;
        }
        
        #selection-notification-bar {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%) !important;
            border: 2px solid #2196f3 !important;
            border-radius: 12px !important;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3) !important;
            animation: slideDown 0.3s ease-out !important;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .action-btn {
            padding: 8px 16px !important;
            border-radius: 8px !important;
            font-weight: 600 !important;
            transition: all 0.2s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
        }
        
        .action-btn:hover:not(.disabled) {
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15) !important;
        }
        
        .action-btn.disabled {
            opacity: 0.5 !important;
            cursor: not-allowed !important;
        }
    </style>
</head>

<body class="bg-gray-50">

<div class="w-full bg-white min-h-screen">
    
    <!-- Header -->
    <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-4 lg:px-6">
        <!-- Left Section -->
        <div class="flex items-center gap-2 lg:gap-4 flex-shrink-0">
            <button class="p-2 rounded-full hover:bg-gray-100">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                </svg>
            </button>
            <div class="flex items-center gap-2 lg:gap-3">
                <img src="https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_48dp.png" alt="Drive" class="w-8 h-8 lg:w-10 lg:h-10">
                <span class="text-lg lg:text-xl text-gray-600 hidden sm:block">TG Drive</span>
            </div>
        </div>
        
        <!-- Center Section - Search Bar -->
        <div class="flex-1 max-w-2xl mx-4 lg:mx-8">
            <div class="relative bg-gray-100 rounded-lg px-3 lg:px-4 py-2 lg:py-3 flex items-center">
                <svg class="w-4 h-4 lg:w-5 lg:h-5 text-gray-500 mr-2 lg:mr-3" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                </svg>
                <form id="search-form" class="flex-1">
                    <input id="file-search" type="text" placeholder="Telusuri di Drive" class="flex-1 bg-transparent outline-none text-sm lg:text-base" autocomplete="off">
                </form>
            </div>
        </div>
        
        <!-- Right Section -->
        <div class="flex items-center gap-1 lg:gap-2 flex-shrink-0">
            <button class="p-1.5 lg:p-2 rounded-full hover:bg-gray-100">
                <svg class="w-5 h-5 lg:w-6 lg:h-6 text-gray-500" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
            </button>
            <div class="w-7 h-7 lg:w-8 lg:h-8 bg-red-500 rounded-full flex items-center justify-center text-white text-xs lg:text-sm font-medium">
                A
            </div>
        </div>
    </header>

    <div class="flex">
        <!-- Sidebar -->
        <aside class="w-56 lg:w-64 xl:w-72 bg-white border-r border-gray-200 p-3 lg:p-4 flex-shrink-0">
            <div class="relative mb-4 lg:mb-6">
                <button id="new-button" class="w-full bg-white border border-gray-300 rounded-full px-4 lg:px-6 py-2 lg:py-3 flex items-center gap-2 lg:gap-3 shadow-md hover:shadow-lg transition-shadow">
                    <svg class="w-5 h-5 lg:w-6 lg:h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    <span class="font-medium text-sm lg:text-base">Baru</span>
                </button>
            
                <!-- Upload Dropdown Menu -->
                <div id="new-upload" class="new-upload">
                    <input id="new-upload-focus" type="text" style="height: 0px; width: 0px; border: none; position: absolute" readonly />
                    <div id="new-folder-btn" class="upload-option">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"/>
                        </svg>
                        <span>New Folder</span>
                    </div>
                    <hr />
                    <div id="file-upload-btn" class="upload-option">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                        </svg>
                        <span>File Upload</span>
                    </div>
                    <input type="file" id="fileInput" style="height: 0px; width: 0px; border: none; position: absolute" />
                    <hr />
                    <div id="url-upload-btn" class="upload-option">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z"/>
                        </svg>
                        <span>URL Upload</span>
                    </div>
                </div>
            </div>
            
            <nav class="space-y-1 sidebar-menu">
                <a href="/?path=/home" class="flex items-center gap-3 px-4 py-2 unselected-item">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                    </svg>
                    <span>Beranda</span>
                </a>
                <a href="/?path=/" class="flex items-center gap-3 px-4 py-2 selected-item">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M10 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2h-8l-2-2z"/>
                    </svg>
                    <span>Drive Saya</span>
                </a>
                <a href="/?path=/" class="flex items-center gap-3 px-4 py-2 unselected-item">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A1.5 1.5 0 0 0 18.54 8H16c-.8 0-1.54.37-2.01 1l-2.99 4H8l-1-1H4v2h2l3.8 3.2L8.5 19H7v2h9.5c1.1 0 2-.9 2-2z"/>
                    </svg>
                    <span>Drive bersama</span>
                </a>
            </nav>
            
            <hr class="my-4 border-gray-200">
            
            <nav class="space-y-1">
                <a href="/?path=/" class="flex items-center gap-3 px-4 py-2 unselected-item">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                    </svg>
                    <span>Berbintang</span>
                </a>
                <a href="/?path=/trash" class="flex items-center gap-3 px-4 py-2 unselected-item">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M3 4V1h2v3h3v2H5v3H3V6H0V4h3zm3 6V7h3V4h7l1.83 2H21c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V10h3z"/>
                    </svg>
                    <span>Sampah</span>
                </a>
                <a href="/?path=/" class="flex items-center gap-3 px-4 py-2 unselected-item">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/>
                    </svg>
                    <span>Penyimpanan</span>
                </a>
            </nav>
            
            <div class="mt-8 px-4">
                <div class="text-xs text-gray-500 mb-2">46,33 GB dari 2 TB digunakan</div>
                <div class="h-2 bg-gray-200 rounded-full mb-3">
                    <div class="h-full w-1/4 bg-gradient-to-r from-blue-500 via-green-500 to-yellow-500 rounded-full"></div>
                </div>
                <button class="w-full text-xs text-blue-600 border border-gray-300 rounded py-2 px-3 hover:bg-gray-50">
                    Dapatkan penyimpanan ekstra
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 bg-white">
            <div class="p-6">
                
                <!-- Page Header -->
                <div class="mb-6">
                    <!-- Title Section -->
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2">
                            <h1 class="text-2xl font-normal text-gray-900">Drive Saya</h1>
                            <button class="p-1 rounded hover:bg-gray-100">
                                <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                        </div>
                        <div class="flex items-center gap-2">
                            <button class="p-2 border border-gray-300 rounded bg-blue-50 text-blue-600">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
                                </svg>
                            </button>
                            <button class="p-2 border border-gray-300 rounded hover:bg-gray-50">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Selection Mode Notification Bar (Hidden by default) -->
                    <div id="selection-notification-bar" class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 flex items-center justify-between" style="display: none;">
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="select-all-checkbox" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                            <span id="selected-count-text" class="text-sm font-medium text-blue-800">
                                <span id="selected-count-header">0</span> item dipilih
                            </span>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="move-selected-btn" class="action-btn bg-blue-600 text-white border-blue-600 hover:bg-blue-700 disabled" disabled>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"/>
                                </svg>
                                Pindahkan
                            </button>
                            <button id="delete-selected-btn" class="action-btn bg-red-600 text-white border-red-600 hover:bg-red-700 disabled" disabled>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M3 6V4h4V2a1 1 0 011-1h8a1 1 0 011 1v2h4v2h-1v13a2 2 0 01-2 2H6a2 2 0 01-2-2V6H3zm3 0v13h12V6H6zm2 2h2v9H8V8zm4 0h2v9h-2V8z"/>
                                </svg>
                                Hapus
                            </button>
                            <button id="cancel-select-btn" class="action-btn">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                                </svg>
                                Batal
                            </button>
                        </div>
                    </div>

                    <!-- Filter Bar -->
                    <div class="flex flex-wrap gap-3 justify-between items-center">
                        <div class="flex flex-wrap gap-3">
                            <button class="flex items-center gap-1 border border-gray-300 rounded px-3 py-1.5 text-sm bg-white hover:bg-gray-50">
                                <span>Jenis</span>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                            <button class="flex items-center gap-1 border border-gray-300 rounded px-3 py-1.5 text-sm bg-white hover:bg-gray-50">
                                <span>Orang</span>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                            <button class="flex items-center gap-1 border border-gray-300 rounded px-3 py-1.5 text-sm bg-white hover:bg-gray-50">
                                <span>Dimodifikasi</span>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                            <button class="flex items-center gap-1 border border-gray-300 rounded px-3 py-1.5 text-sm bg-white hover:bg-gray-50">
                                <span>Sumber</span>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                        </div>
                        
                        <!-- Info: Selection Mode triggered from context menu -->
                    </div>
                </div>

                <!-- Files Table -->
                <div class="bg-white">
                    <!-- Table Header -->
                    <div class="border-b border-gray-200 py-3">
                        <div id="table-header" class="grid px-4 items-center text-xs font-medium text-gray-600 uppercase tracking-wide" style="grid-template-columns: 1fr 200px 150px 120px 40px;">
                            <!-- Checkbox column (hidden by default) -->
                            <div class="checkbox-column flex justify-center" style="display: none;">
                                <input type="checkbox" id="header-select-all" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                            </div>
                            
                            <div class="flex items-center gap-1">
                                <span>Nama</span>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <div class="flex justify-center">Pemilik</div>
                            <div class="flex justify-center">Tanggal diubah</div>
                            <div class="flex justify-center">Ukuran file</div>
                            <div class="flex justify-center"></div>
                        </div>
                    </div>
                    
                    <!-- Files Container for JavaScript -->
                    <div id="directory-container">
                        <div id="directory-data">
                            <!-- Default placeholder files - will be replaced by JavaScript -->
                            <div class="grid px-4 py-2 items-center hover:bg-gray-50 border-b border-gray-200 cursor-pointer file-item" data-name="tes" data-type="folder" data-path="/tes" style="grid-template-columns: 1fr 200px 150px 120px 40px;">
                                <div class="flex items-center gap-2 truncate">
                                    <span class="text-lg">📁</span>
                                    <span class="text-sm text-gray-900 truncate">tes</span>
                                </div>
                                <div class="flex items-center justify-center gap-2">
                                    <span class="text-sm">🧑</span>
                                    <span class="text-sm text-gray-700">saya</span>
                                </div>
                                <div class="flex justify-center text-sm text-gray-700">8 Des</div>
                                <div class="flex justify-center text-sm text-gray-700">—</div>
                                <div class="flex justify-center">
                                    <button class="more-btn p-1 rounded hover:bg-gray-200 transition-colors" onclick="event.stopPropagation(); showContextMenu(event, 'tes', 'folder', '/tes')">
                                        <svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid px-4 py-2 items-center hover:bg-gray-50 border-b border-gray-200 cursor-pointer file-item" data-name="Anime" data-type="folder" data-path="/Anime" style="grid-template-columns: 1fr 200px 150px 120px 40px;">
                                <div class="flex items-center gap-2 truncate">
                                    <span class="text-lg">📁</span>
                                    <span class="text-sm text-gray-900 truncate">Anime</span>
                                </div>
                                <div class="flex items-center justify-center gap-2">
                                    <span class="text-sm">🧑</span>
                                    <span class="text-sm text-gray-700">saya</span>
                                </div>
                                <div class="flex justify-center text-sm text-gray-700">7 Des</div>
                                <div class="flex justify-center text-sm text-gray-700">—</div>
                                <div class="flex justify-center">
                                    <button class="more-btn p-1 rounded hover:bg-gray-200 transition-colors" onclick="event.stopPropagation(); showContextMenu(event, 'Anime', 'folder', '/Anime')">
                                        <svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid px-4 py-2 items-center hover:bg-gray-50 border-b border-gray-200 cursor-pointer file-item" data-name="[ANICHIN.REST][Super_Cube][EP05].[1080p].mp4" data-type="file" data-path="/[ANICHIN.REST][Super_Cube][EP05].[1080p].mp4" style="grid-template-columns: 1fr 200px 150px 120px 40px;">
                                <div class="flex items-center gap-2 truncate">
                                    <span class="text-lg">🎞️</span>
                                    <span class="text-sm text-gray-900 truncate">[ANICHIN.REST][Super_Cube][EP05].[1080p].mp4</span>
                                </div>
                                <div class="flex items-center justify-center gap-2">
                                    <span class="text-sm">🧑</span>
                                    <span class="text-sm text-gray-700">saya</span>
                                </div>
                                <div class="flex justify-center text-sm text-gray-700">6 Des</div>
                                <div class="flex justify-center text-sm text-gray-700">109 KB</div>
                                <div class="flex justify-center">
                                    <button class="more-btn p-1 rounded hover:bg-gray-200 transition-colors" onclick="event.stopPropagation(); showContextMenu(event, '[ANICHIN.REST][Super_Cube][EP05].[1080p].mp4', 'file', '/[ANICHIN.REST][Super_Cube][EP05].[1080p].mp4')">
                                        <svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </main>
    </div>
</div>

<!-- Hidden elements for compatibility with existing JavaScript -->
<div id="bg-blur" class="bg-blur"></div>

<!-- Modal dialogs -->
<div id="create-new-folder" class="create-new-folder">
    <span>New Folder</span>
    <input type="text" id="new-folder-name" placeholder="Enter Folder Name" autocomplete="off" />
    <div>
        <button id="new-folder-cancel">Cancel</button>
        <button id="new-folder-create">Create</button>
    </div>
</div>

<div id="rename-file-folder" class="create-new-folder">
    <span>Edit File/Folder Name</span>
    <input type="text" id="rename-name" placeholder="Enter File/Folder Name" autocomplete="off" />
    <div>
        <button id="rename-cancel">Cancel</button>
        <button id="rename-create">Rename</button>
    </div>
</div>

<div id="new-url-upload" class="create-new-folder">
    <span>Url Upload</span>
    <input type="text" id="remote-url" placeholder="Enter Direct Download Link Of File" autocomplete="off" />
    <div id="single-threaded-div">
        <input type="checkbox" name="single-threaded-toggle" id="single-threaded-toggle">
        <label for="single-threaded-toggle">Single Threaded</label>
        <a href="#"><img src="static/assets/info-icon-small.svg" alt="Info"></a>
    </div>
    <div>
        <button id="remote-cancel">Cancel</button>
        <button id="remote-start">Upload</button>
    </div>
</div>

<div id="get-password" class="create-new-folder">
    <span>Admin Login</span>
    <input type="text" id="auth-pass" placeholder="Enter Password" autocomplete="off" />
    <div>
        <button id="pass-login">Login</button>
    </div>
</div>

<div id="move-files-dialog" class="create-new-folder">
    <span>Move Selected Files</span>
    <div class="selected-files-info" id="selected-files-info">
        <span id="selected-count">0 files selected</span>
    </div>
    <div class="folder-picker">
        <label for="destination-folder">Choose destination folder:</label>
        <select id="destination-folder" class="folder-select">
            <option value="">Loading folders...</option>
        </select>
    </div>
    <div>
        <button id="move-cancel">Cancel</button>
        <button id="move-confirm">Move Files</button>
    </div>
</div>

<div id="file-uploader" class="file-uploader">
    <span class="upload-head">🚀 Uploading File...</span>
    <span id="upload-filename" class="upload-info">Filename : </span>
    <span id="upload-filesize" class="upload-info">Filesize :</span>
    <span id="upload-status" class="upload-info">Status : </span>
    <span id="upload-percent" class="upload-info">Progress : </span>
    <div class="progress">
        <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div class="btn-div">
        <button id="cancel-file-upload">Cancel Upload</button>
    </div>
</div>

<script src="static/js/extra.js"></script>
<script src="static/js/apiHandler.js"></script>
<script src="static/js/sidebar.js"></script>
<script src="static/js/fileClickHandler.js"></script>
<script src="static/js/moveFiles.js"></script>
<script src="static/js/main.js"></script>
<script src="static/js/context-menu.js"></script>
<script src="static/js/google-drive-enhancements.js"></script>

<!-- MANUAL SELECTION FIX SCRIPT -->
<script>
// 🛠️ MANUAL SELECTION FIX - Memaksa fitur pilih bekerja
console.log('🔧 Loading manual selection fix...');

// Global variables
let manualSelectedFiles = new Set();
let manualSelectionMode = false;

// Force CSS injection
function injectSelectionCSS() {
    const style = document.createElement('style');
    style.id = 'manual-selection-css';
    style.innerHTML = `
        .manual-selected {
            background-color: #c2e7ff !important;
            border: 2px solid #1a73e8 !important;
            border-radius: 8px !important;
            box-shadow: 0 2px 8px rgba(26, 115, 232, 0.3) !important;
            transform: translateY(-1px) !important;
            transition: all 0.2s ease !important;
        }
        
        .manual-checkbox {
            appearance: none !important;
            width: 18px !important;
            height: 18px !important;
            border: 2px solid #dadce0 !important;
            border-radius: 3px !important;
            cursor: pointer !important;
            position: relative !important;
            background: white !important;
            margin-right: 8px !important;
        }
        
        .manual-checkbox:checked {
            background-color: #1a73e8 !important;
            border-color: #1a73e8 !important;
        }
        
        .manual-checkbox:checked::after {
            content: '✓' !important;
            position: absolute !important;
            top: -1px !important;
            left: 2px !important;
            color: white !important;
            font-size: 12px !important;
            font-weight: bold !important;
        }
        
        #manual-notification-bar {
            position: fixed !important;
            top: 80px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%) !important;
            border: 2px solid #2196f3 !important;
            border-radius: 12px !important;
            padding: 12px 20px !important;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3) !important;
            z-index: 10000 !important;
            display: none !important;
            font-weight: 600 !important;
            color: #1565c0 !important;
            font-family: Arial, sans-serif !important;
        }
        
        .manual-action-btn {
            background: #1976d2 !important;
            color: white !important;
            border: none !important;
            padding: 8px 16px !important;
            border-radius: 6px !important;
            margin: 0 4px !important;
            cursor: pointer !important;
            font-weight: 600 !important;
            font-size: 12px !important;
        }
        
        .manual-action-btn:hover {
            background: #1565c0 !important;
            transform: translateY(-1px) !important;
        }
        
        .manual-action-btn.cancel {
            background: #f44336 !important;
        }
        
        .manual-action-btn.cancel:hover {
            background: #d32f2f !important;
        }
    `;
    document.head.appendChild(style);
    console.log('✅ Manual selection CSS injected');
}

// Create notification bar
function createNotificationBar() {
    let notificationBar = document.getElementById('manual-notification-bar');
    if (!notificationBar) {
        notificationBar = document.createElement('div');
        notificationBar.id = 'manual-notification-bar';
        notificationBar.innerHTML = `
            <span id="manual-count-text">0 item dipilih</span>
            <button class="manual-action-btn" onclick="manualMoveFiles()">Pindahkan</button>
            <button class="manual-action-btn" onclick="manualDeleteFiles()">Hapus</button>
            <button class="manual-action-btn cancel" onclick="manualCancelSelection()">Batal</button>
        `;
        document.body.appendChild(notificationBar);
        console.log('✅ Manual notification bar created');
    }
    return notificationBar;
}

// Manual selection function
function manualSelectFile(fileElement) {
    console.log('🎯 Manual select file:', fileElement.getAttribute('data-name'));
    
    const fileId = fileElement.getAttribute('data-path') || fileElement.getAttribute('data-name');
    
    // Toggle selection
    if (manualSelectedFiles.has(fileId)) {
        // Deselect
        manualSelectedFiles.delete(fileId);
        fileElement.classList.remove('manual-selected');
        
        // Remove checkbox if exists
        const checkbox = fileElement.querySelector('.manual-checkbox');
        if (checkbox) {
            checkbox.remove();
        }
        
        console.log('❌ Deselected:', fileId);
    } else {
        // Select
        manualSelectedFiles.add(fileId);
        fileElement.classList.add('manual-selected');
        
        // Add checkbox
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'manual-checkbox';
        checkbox.checked = true;
        fileElement.insertBefore(checkbox, fileElement.firstChild);
        
        console.log('✅ Selected:', fileId);
    }
    
    // Update UI
    updateManualNotification();
    
    // Enter selection mode if not already
    if (!manualSelectionMode && manualSelectedFiles.size > 0) {
        manualSelectionMode = true;
        document.body.classList.add('manual-selection-mode');
        console.log('⚡ Entered manual selection mode');
    } else if (manualSelectedFiles.size === 0) {
        manualSelectionMode = false;
        document.body.classList.remove('manual-selection-mode');
    }
}

// Update notification
function updateManualNotification() {
    const count = manualSelectedFiles.size;
    const countText = document.getElementById('manual-count-text');
    const notificationBar = document.getElementById('manual-notification-bar');
    
    if (countText) {
        countText.textContent = `${count} item dipilih`;
    }
    
    if (notificationBar) {
        if (count > 0) {
            notificationBar.style.display = 'block';
            notificationBar.style.animation = 'slideDown 0.3s ease-out';
        } else {
            notificationBar.style.display = 'none';
        }
    }
    
    console.log('📊 Updated notification:', count, 'items selected');
}

// Cancel selection
function manualCancelSelection() {
    console.log('🚪 Manual cancel selection');
    
    // Remove all selections
    document.querySelectorAll('.manual-selected').forEach(item => {
        item.classList.remove('manual-selected');
    });
    
    // Remove all checkboxes
    document.querySelectorAll('.manual-checkbox').forEach(cb => cb.remove());
    
    // Clear state
    manualSelectedFiles.clear();
    manualSelectionMode = false;
    document.body.classList.remove('manual-selection-mode');
    
    // Hide notification
    updateManualNotification();
    
    console.log('✅ Manual selection cancelled');
}

// Move files (placeholder - akan terhubung ke API real)
function manualMoveFiles() {
    if (manualSelectedFiles.size === 0) return;
    
    alert(`📁 Akan memindahkan ${manualSelectedFiles.size} file:\n\n${Array.from(manualSelectedFiles).join('\n')}\n\n(Ini adalah demo - nanti akan terhubung ke API asli)`);
    console.log('📁 Move files:', Array.from(manualSelectedFiles));
}

// Delete files (placeholder - akan terhubung ke API real)
function manualDeleteFiles() {
    if (manualSelectedFiles.size === 0) return;
    
    if (confirm(`🗑️ Yakin ingin menghapus ${manualSelectedFiles.size} file?`)) {
        alert(`🗑️ File berhasil dihapus:\n\n${Array.from(manualSelectedFiles).join('\n')}\n\n(Ini adalah demo - nanti akan terhubung ke API asli)`);
        console.log('🗑️ Delete files:', Array.from(manualSelectedFiles));
        manualCancelSelection();
    }
}

// Override context menu to use manual selection
function setupManualContextMenu() {
    console.log('🔧 Setting up manual context menu...');
    
    // Remove existing event listeners and add new ones
    document.querySelectorAll('.file-item').forEach(item => {
        // Clone to remove existing event listeners
        const newItem = item.cloneNode(true);
        item.parentNode.replaceChild(newItem, item);
        
        // Add new context menu listener
        newItem.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const fileName = newItem.getAttribute('data-name');
            const fileType = newItem.getAttribute('data-type');
            
            console.log('🖱️ Right-click on:', fileName, 'type:', fileType);
            
            // Remove existing menu if any
            const existingMenu = document.getElementById('manual-context-menu');
            if (existingMenu) existingMenu.remove();
            
            // Create context menu
            const menu = document.createElement('div');
            menu.id = 'manual-context-menu';
            menu.style.cssText = `
                position: fixed;
                left: ${e.clientX}px;
                top: ${e.clientY}px;
                background: white;
                border: 1px solid #ddd;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                z-index: 10001;
                min-width: 180px;
                padding: 8px 0;
                font-family: Arial, sans-serif;
                font-size: 14px;
            `;
            
            const isSelected = manualSelectedFiles.has(newItem.getAttribute('data-path') || newItem.getAttribute('data-name'));
            
            menu.innerHTML = `
                <div style="padding: 12px 16px; cursor: pointer; transition: background 0.2s;" 
                     onmouseover="this.style.backgroundColor='#f5f5f5'" 
                     onmouseout="this.style.backgroundColor='white'"
                     onclick="manualSelectFile(document.querySelector('[data-name=\\'${fileName}\\']')); document.getElementById('manual-context-menu').remove();">
                    ${isSelected ? '☑️ Batal Pilih' : '☑️ Pilih'}
                </div>
                <div style="padding: 12px 16px; cursor: pointer; transition: background 0.2s;" 
                     onmouseover="this.style.backgroundColor='#f5f5f5'" 
                     onmouseout="this.style.backgroundColor='white'"
                     onclick="alert('Fitur ${fileType === 'folder' ? 'Buka Folder' : 'Buka File'} belum tersedia'); document.getElementById('manual-context-menu').remove();">
                    📂 ${fileType === 'folder' ? 'Buka Folder' : 'Buka File'}
                </div>
                <hr style="margin: 8px 0; border: none; height: 1px; background: #eee;">
                <div style="padding: 12px 16px; cursor: pointer; transition: background 0.2s;" 
                     onmouseover="this.style.backgroundColor='#f5f5f5'" 
                     onmouseout="this.style.backgroundColor='white'"
                     onclick="alert('Fitur Ganti Nama belum tersedia'); document.getElementById('manual-context-menu').remove();">
                    ✏️ Ganti Nama
                </div>
                <div style="padding: 12px 16px; cursor: pointer; transition: background 0.2s;" 
                     onmouseover="this.style.backgroundColor='#f5f5f5'" 
                     onmouseout="this.style.backgroundColor='white'"
                     onclick="alert('Fitur Hapus belum tersedia'); document.getElementById('manual-context-menu').remove();">
                    🗑️ Hapus
                </div>
            `;
            
            document.body.appendChild(menu);
            
            console.log('✅ Context menu created and displayed');
            
            // Remove menu when clicking outside
            setTimeout(() => {
                const removeMenu = (event) => {
                    if (!menu.contains(event.target)) {
                        menu.remove();
                        document.removeEventListener('click', removeMenu);
                    }
                };
                document.addEventListener('click', removeMenu);
            }, 100);
        });
    });
    
    console.log('✅ Manual context menu setup completed for', document.querySelectorAll('.file-item').length, 'items');
}

// Initialize manual selection system
function initManualSelection() {
    console.log('🚀 Initializing manual selection system...');
    
    try {
        injectSelectionCSS();
        createNotificationBar();
        setupManualContextMenu();
        
        // Expose functions globally
        window.manualSelectFile = manualSelectFile;
        window.manualCancelSelection = manualCancelSelection;
        window.manualMoveFiles = manualMoveFiles;
        window.manualDeleteFiles = manualDeleteFiles;
        
        console.log('✅ Manual selection system ready!');
        console.log('💡 Klik kanan pada file/folder dan pilih "Pilih"');
        console.log('📊 System status: ACTIVE and READY');
        
        // Show success notification
        setTimeout(() => {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4caf50;
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10002;
                font-family: Arial, sans-serif;
                font-weight: 600;
            `;
            toast.textContent = '✅ Fitur Pilih Siap Digunakan!';
            document.body.appendChild(toast);
            
            setTimeout(() => toast.remove(), 3000);
        }, 500);
        
    } catch (error) {
        console.error('❌ Error initializing manual selection:', error);
    }
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initManualSelection);
} else {
    initManualSelection();
}

console.log('🎉 Manual selection fix script loaded and ready!');
</script>
</body>

</html>